#
# Check for:
#
# - OpenStackControlPlane
# - OpenStackVMSet
# - OpenStackClient
# - OpenStackNet (IP reservations for OpenStackControlPlane and OpenStackClient)
# - OpenStackIPSets (IP reservations for OpenStackControlPlane and OpenStackClient)
#

apiVersion: osp-director.openstack.org/v1beta1
kind: OpenStackControlPlane
metadata:
  name: overcloud
  namespace: openstack
spec:
  controller:
    Role: Controller
    baseImageURL: http://download.eng.brq.redhat.com/brewroot/packages/rhel-guest-image/8.3/417/images/rhel-guest-image-8.3-417.x86_64.qcow2
    baseImageVolumeName: openstack-base-img
    controllerCount: 0
    cores: 2
    diskSize: 50
    memory: 20
    networks:
    - ctlplane
    ospNetwork:
      bridgeName: br-osp
      desiredState:
        interfaces:
        - bridge:
            options:
              stp:
                enabled: false
            port:
            - name: enp6s0
          description: Linux bridge with enp6s0 as a port
          name: br-osp
          state: up
          type: linux-bridge
      name: osp
    role: controller
    storageClass: host-nfs-storageclass
  openStackClientImageURL: quay.io/openstack-k8s-operators/tripleo-deploy:latest
---
apiVersion: osp-director.openstack.org/v1beta1
kind: OpenStackVMSet
metadata:
  name: controller
  namespace: openstack
spec:
  baseImageURL: http://download.eng.brq.redhat.com/brewroot/packages/rhel-guest-image/8.3/417/images/rhel-guest-image-8.3-417.x86_64.qcow2
  baseImageVolumeName: openstack-base-img
  cores: 2
  deploymentSSHSecret: osp-controlplane-ssh-keys
  diskSize: 50
  memory: 20
  networks:
  - ctlplane
  ospNetwork:
    bridgeName: br-osp
    desiredState:
      interfaces:
      - bridge:
          options:
            stp:
              enabled: false
          port:
          - name: enp6s0
        description: Linux bridge with enp6s0 as a port
        name: br-osp
        state: up
        type: linux-bridge
    name: osp
  role: controller
  storageClass: host-nfs-storageclass
  vmCount: 0
status:
  baseImageDVReady: true
---
apiVersion: osp-director.openstack.org/v1beta1
kind: OpenStackClient
metadata:
  name: openstackclient
  namespace: openstack
spec:
  cloudName: overcloud
  deploymentSSHSecret: osp-controlplane-ssh-keys
  imageURL: quay.io/openstack-k8s-operators/tripleo-deploy:latest
  networks:
  - ctlplane
status:
  netStatus:
    openstackclient-0:
      hostname: openstackclient-0
      ipaddresses:
        ctlplane: 192.168.25.101/24
---
apiVersion: osp-director.openstack.org/v1beta1
kind: OpenStackNet
metadata:
  name: ctlplane
  namespace: openstack
status:
  reservations:
  - addToPredictableIPs: false
    hostname: controlplane-0
    idKey: controlplane-0
    ip: 192.168.25.100
    role: ControlPlane
    vip: true
  - addToPredictableIPs: false
    hostname: openstackclient-0
    idKey: openstackclient-0
    ip: 192.168.25.101
    role: OpenstackClient
    vip: false
---
apiVersion: osp-director.openstack.org/v1beta1
kind: OpenStackIPSet
metadata:
  labels:
    addToPredictableIPsLabel: "false"
  name: overcloud
  namespace: openstack
spec:
  addToPredictableIPs: false
  hostCount: 1
  networks:
  - ctlplane
  role: ControlPlane
  vip: true
status:
  hosts:
    controlplane-0:
      ipaddresses:
        ctlplane: 192.168.25.100/24
  networks:
    ctlplane:
      allocationEnd: 192.168.25.250
      allocationStart: 192.168.25.100
      cidr: 192.168.25.0/24
      gateway: 192.168.25.1
---
apiVersion: osp-director.openstack.org/v1beta1
kind: OpenStackIPSet
metadata:
  labels:
    addToPredictableIPsLabel: "false"
  name: openstackclient
  namespace: openstack
spec:
  addToPredictableIPs: false
  hostCount: 1
  networks:
  - ctlplane
  role: OpenstackClient
  vip: false
status:
  hosts:
    openstackclient-0:
      ipaddresses:
        ctlplane: 192.168.25.101/24
  networks:
    ctlplane:
      allocationEnd: 192.168.25.250
      allocationStart: 192.168.25.100
      cidr: 192.168.25.0/24
      gateway: 192.168.25.1

